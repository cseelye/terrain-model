#!/usr/bin/env bash
set -euo pipefail

NAME=${NAME:-terrain-model}
REPO=${REPO:-ghcr.io/cseelye}
TAG=${TAG-latest}

if [[ -n ${REPO} ]]; then
    IMAGE_NAME=${REPO}/${NAME}
else
    IMAGE_NAME=${NAME}
fi


for stage in prod dev; do
(
    fullname=${IMAGE_NAME}.${target}:${TAG}
    if [[ ${target} == "prod" ]]; then
        fullname=${IMAGE_NAME}:${TAG}
    fi
    set -x
    docker image push ${fullname}
)
done
